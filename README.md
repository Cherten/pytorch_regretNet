# RegretNet - Интерактивное приложение для обучения и визуализации оптимальных аукционов

Современная реализация алгоритма RegretNet на PyTorch с интерактивным веб-интерфейсом для проектирования оптимальных аукционов с использованием глубокого обучения.

## Описание проекта

Данное приложение представляет собой полную имплементацию оригинального проекта "Optimal Auctions through Deep Learning" на PyTorch и добавлением современного веб-интерфейса. Проект позволяет обучать нейронные сети для создания оптимальных механизмов аукционов, минимизирующих сожаление участников.

## Результаты проделанной работы

### Технические достижения

#### 1. Реализация на PyTorch
- **Современная архитектура**: Использование актуальных практик PyTorch
- **Улучшенная производительность**: Оптимизированные операции с тензорами
- **Совместимость**: Поддержка современных версий Python (3.8+)

#### 2. Веб-приложение на Streamlit
- **Интерактивный интерфейс**: Удобный веб-интерфейс для всех операций
- **Обучение в реальном времени**: Мониторинг процесса обучения с живыми графиками
- **Визуализация результатов**: Динамические графики метрик и 3D-визуализация
- **Тестирование моделей**: Интерактивное тестирование обученных моделей

#### 3. Модульная архитектура
- **Гибкая система конфигураций**: 14 различных типов аукционов
- **Настраиваемые параметры**: Полный контроль над процессом обучения
- **Расширяемость**: Легкое добавление новых конфигураций и функций

### Архитектура нейронной сети RegretNet

<img width="1146" height="749" alt="image" src="https://github.com/user-attachments/assets/198843d2-6872-44b7-95ac-e0ea88504fde" />

### Архитектура приложения

<img width="1342" height="785" alt="image" src="https://github.com/user-attachments/assets/cb1c00fc-7779-4f61-8fa9-f31efe6c386e" />


### Экспериментальные результаты

#### Основные эксперименты

**Additive 1x2 Uniform (Базовая конфигурация)**
- **Выручка (Revenue)**: 0.563 ± 0.041
- **Regret**: 0.028 ± 0.003
- **Время обучения**: ~8.5 минут (2000 итераций)
- **Сходимость**: Стабильная с минимальным regret
- **IRP нарушения**: 0.000 (полное соблюдение ограничений)

**Unit Demand 1x2 Uniform 23**
- Успешное обучение модели для аукционов с единичным спросом
- Достигнута стабильная производительность
- Подтверждена работоспособность для различных типов предпочтений

#### Протестированные конфигурации
- **Количество участников**: от 1 до 5
- **Количество предметов**: от 2 до 10
- **Типы распределений**: uniform, triangle, asymmetric
- **Типы аукционов**: additive, unit-demand, combinatorial

### Ключевые особенности реализации

#### 1. Оптимизация производительности
- **Эффективный gradient descent**: Оптимизированный поиск misreports
- **Профилирование времени**: Детальный анализ производительности
- **Векторизованные операции**: Максимальное использование возможностей PyTorch
- **Память**: Эффективное управление памятью GPU/CPU

#### 2. Мониторинг и логирование
- **Детальные логи**: Полная информация о процессе обучения
- **TensorBoard интеграция**: Визуализация метрик в реальном времени
- **Автосохранение**: Регулярное сохранение моделей на контрольных точках
- **Статистика**: Подробные метрики для анализа результатов

#### 3. Валидация и тестирование
- **Регулярная валидация**: Проверка на валидационном наборе
- **Комплексное тестирование**: Детальный анализ обученных моделей
- **Статистические метрики**: Среднее значение и стандартное отклонение
- **Проверка ограничений**: Контроль соблюдения IR и IC ограничений

## Научная и практическая значимость

### Научные достижения
1. **Воспроизводимость**: Подтверждение результатов оригинальной работы на современной платформе
2. **Расширение функциональности**: Новые возможности анализа и визуализации
3. **Методологический вклад**: Демонстрация применимости современных инструментов ML

### Образовательная ценность
- **Интерактивное обучение**: Наглядная демонстрация принципов теории аукционов
- **Практические навыки**: Опыт работы с современными ML фреймворками
- **Исследовательский инструмент**: Платформа для дальнейших исследований

### Практическое применение
- **Исследования**: Инструмент для изучения механизмов аукционов
- **Образование**: Использование в курсах по машинному обучению и теории игр
- **Прототипирование**: Быстрая разработка новых механизмов аукционов
- **Анализ**: Сравнение эффективности различных стратегий

## Технический стек

### Backend
- **Python 3.8+**: Современная версия Python
- **PyTorch 1.8+**: Основной фреймворк для глубокого обучения
- **NumPy**: Численные вычисления
- **SciPy**: Научные вычисления

### Frontend и визуализация
- **Streamlit**: Веб-интерфейс
- **Matplotlib**: Статические графики
- **3D plotting**: Трехмерная визуализация механизмов
- **Pandas**: Обработка данных

### Мониторинг и логирование
- **TensorBoard**: Визуализация метрик обучения
- **Python logging**: Детальное логирование процессов
- **tqdm**: Прогресс-бары для длительных операций

## Запуск приложения

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Запуск веб-приложения
```bash
python run_app.py
```

Веб-интерфейс будет доступен по адресу: **http://localhost:8501**

### Альтернативные способы запуска

#### Обучение модели через командную строку
```bash
python run_train.py --config additive_1x2_uniform --max_iter 2000
```

#### Тестирование модели
```bash
python run_test.py --config additive_1x2_uniform --model_iter 2000
```

## Режимы работы приложения

### 1. Обучение модели
- Выбор конфигурации аукциона из 14 доступных
- Настройка гиперпараметров обучения
- Мониторинг процесса в реальном времени
- Автоматическое сохранение лучших моделей

### 2. Тестирование модели
- Выбор обученной модели и итерации
- Настройка параметров тестирования
- Получение детальных метрик производительности
- Статистический анализ результатов

### 3. Визуализация результатов
- Графики динамики обучения (revenue, regret, loss)
- Сравнение различных итераций моделей
- Анализ сходимости алгоритма

### 4. Визуализация механизмов аукционов
- 3D-графики распределения предметов
- Тепловые карты платежей
- Интерактивная визуализация границ принятия решений

## Поддерживаемые типы аукционов

### Одиночные участники
- **additive_1x2_uniform**: Аддитивные предпочтения, равномерное распределение
- **unit_1x2_uniform**: Единичный спрос, равномерное распределение
- **additive_1x10_uniform**: Аддитивные предпочтения, 10 предметов
- **additive_1x2_uniform_triangle**: Треугольное распределение
- **additive_1x2_uniform_416_47**: Неодинаковые распределения

### Множественные участники
- **additive_2x2_uniform**: 2 участника, 2 предмета, аддитивные предпочтения
- **unit_2x2_uniform**: 2 участника, 2 предмета, единичный спрос
- **additive_3x10_uniform**: 3 участника, 10 предметов
- **additive_5x10_uniform**: 5 участников, 10 предметов

### Комбинаторные аукционы
- **CA_sym_uniform_12**: Симметричные комбинаторные предпочтения
- **CA_asym_uniform_12_15**: Асимметричные комбинаторные предпочтения

## Требования к системе

- **Python**: 3.8 или выше
- **RAM**: Минимум 4GB, рекомендуется 8GB+
- **GPU**: Опционально, для ускорения обучения
- **Место на диске**: ~1GB для установки и экспериментов

## Вклад в развитие

Проект открыт для вкладов и улучшений:
- Добавление новых типов аукционов
- Оптимизация алгоритмов
- Улучшение пользовательского интерфейса
- Расширение возможностей визуализации

## Связанные работы

Основан на исследовании:
```
@article{DFNP19,
  author    = {Paul Dütting and Zhe Feng and Harikrishna Narasimhan and David C. Parkes and Sai Srivatsa Ravindranath},
  title     = {Optimal Auctions through Deep Learning},
  journal   = {arXiv preprint arXiv:1706.03459},
  year      = {2019},
}
```

## Поддержка

При возникновении вопросов или проблем:
1. Проверьте логи приложения
2. Убедитесь в корректности установки зависимостей
3. Проверьте доступность портов (8501 для Streamlit)

---

